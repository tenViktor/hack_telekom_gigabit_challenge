# backend/exploits/playwright_runner.py
from playwright.async_api import async_playwright
import asyncio

class PlaywrightExploitRunner:
    async def run_exploit(self, script: str, target_url: str):
        async with async_playwright() as p:
            browser = await p.chromium.launch()
            context = await browser.new_context()
            page = await context.new_page()
            
            try:
                # Execute the generated script
                await exec(script, {"page": page, "target_url": target_url})
                
                # Take screenshot
                await page.screenshot(
                    path=f"evidence_{datetime.now()}.png"
                )
                
                return True
            except Exception as e:
                return False
